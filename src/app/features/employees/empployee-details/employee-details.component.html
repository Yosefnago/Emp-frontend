<!-- Header Section -->
<div class="employee-details-container">
  <!-- Back Button & Title -->
  <div class="details-header">
    <button class="back-button" (click)="goBack()" aria-label="专">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="19" y1="12" x2="5" y2="12"></line>
        <polyline points="12 19 5 12 12 5"></polyline>
      </svg>
      <span>专</span>
    </button>
  
    <div class="header-content">
      <h1 class="employee-name">{{ employee?.firstName }} {{ employee?.lastName }}</h1>
      <p class="personal-id">转.: {{ employee?.personalId }}</p>
    </div>
  </div>

  <!-- Employee Statistics Cards -->
  <section class="statistics-section">
    <div class="stats-grid">
      <div class="stat-card stat-card-blue">
        <div class="stat-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
            <path d="M20 10c0 7-3 11-8 11s-8-4-8-11" />
            <circle cx="12" cy="4" r="3" />
          </svg>
        </div>
        <div class="stat-info">
          <p class="stat-label">转驻拽</p>
          <p class="stat-value">{{ employee?.position }}</p>
        </div>
      </div>

      <div class="stat-card stat-card-green">
        <div class="stat-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
            <line x1="16" y1="2" x2="16" y2="6" />
            <line x1="8" y1="2" x2="8" y2="6" />
            <line x1="3" y1="10" x2="21" y2="10" />
          </svg>
        </div>
        <div class="stat-info">
          <p class="stat-label">转专 转</p>
          <p class="stat-value">{{ employee?.hireDate | date:'dd/MM/yyyy' }}</p>
        </div>
      </div>

      <div class="stat-card stat-card-purple">
        <div class="stat-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
            <path d="M23 3v6h-6" />
            <path d="M1 21v-6h6" />
            <path d="M3.51 9a9 9 0 0 1 14.85-4M20.49 15a9 9 0 0 1-14.85 4" />
          </svg>
        </div>
        <div class="stat-info">
          <p class="stat-label">砖 专</p>
          <p class="stat-value">{{ calculateMonthsInCompany() }}</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Attendance Statistics -->
  <section class="attendance-stats-section">
    <h2 class="section-title">转专转   {{ currentDate | date:'dd/MM/yyyy' }}</h2>
    <div class="attendance-stats-grid">
      <div class="attendance-stat-card">
        <div class="stat-badge badge-present">
          <span class="badge-value">{{ attendanceStats?.presentDays || 0 }}</span>
        </div>
        <p class="stat-description"> 转 砖</p>
      </div>

      <div class="attendance-stat-card">
        <div class="stat-badge badge-absent">
          <span class="badge-value">{{ attendanceStats?.absentDays || 0 }}</span>
        </div>
        <p class="stat-description"> 专</p>
      </div>

      <div class="attendance-stat-card">
        <div class="stat-badge badge-sick">
          <span class="badge-value">{{ attendanceStats?.sickDays || 0 }}</span>
        </div>
        <p class="stat-description"> </p>
      </div>

      <div class="attendance-stat-card">
        <div class="stat-badge badge-vacation">
          <span class="badge-value">{{ attendanceStats?.vacationDays || 0 }}</span>
        </div>
        <p class="stat-description"> 驻砖</p>
      </div>

      <div class="attendance-stat-card">
        <div class="stat-badge badge-rate">
          <span class="badge-value">{{ attendanceStats?.attendanceRate || '0' }}%</span>
        </div>
        <p class="stat-description">砖注专 转</p>
      </div>
    </div>
  </section>

  <!-- Tabs Navigation -->
  <div class="tabs-container">
    <div class="tabs-header">
      <button
        class="tab-button"
        [class.active]="activeTab === 'personal'"
        (click)="switchTab('personal')">
         驻专 砖
      </button>
      <button
        class="tab-button"
        [class.active]="activeTab === 'documents'"
        (click)="switchTab('documents')">
         住
      </button>
      <button
        class="tab-button"
        [class.active]="activeTab === 'salary'"
        (click)="switchTab('salary')">
         砖专转
      </button>
    </div>

    <!-- Personal Details Tab -->
    @if (activeTab === 'personal') {
      <div class="tab-content personal-details-tab">
        <div class="details-section">
          <div class="section-header-with-button">
            <h3 class="details-header-title"> 驻专 砖</h3>
            
            @if (isEditMode) {
              <button class="edit-save-btn btn-save" (click)="saveChanges()" aria-label="砖专">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                  <polyline points="17 21 17 13 7 13 7 21"></polyline>
                  <polyline points="7 3 7 8 15 8"></polyline>
                </svg>
                <span>砖专</span>
              </button>
            } @else {
              <button class="edit-save-btn btn-edit" (click)="toggleEditMode()" aria-label="注专">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M12 20h9"></path>
                  <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
                </svg>
                <span>注专</span>
              </button>
            }
          </div>

          <div class="details-grid">
            <div class="detail-item">
              @if (isEditMode) {
                <label class="detail-label">砖 驻专</label>
                <input type="text" class="detail-input" [(ngModel)]="employee.firstName" />
              }@else {
                <label class="detail-label">砖 驻专</label>
                <p class="detail-value">{{ employee?.firstName }}</p>
              }
            </div>
            <div class="detail-item">
              @if (isEditMode) {
                <label class="detail-label">砖 砖驻</label>
                <input type="text" class="detail-input" [(ngModel)]="employee.lastName" />
              }@else {
                <label class="detail-label">砖 砖驻</label>
                <p class="detail-value">{{ employee?.lastName }}</p>
              }
            </div>
            <div class="detail-item">
              @if (isEditMode) {
                <label class="detail-label">转注转 转</label>
                <input type="text" class="detail-input" [(ngModel)]="employee.personalId" />
              }@else {
                <label class="detail-label">转注转 转</label>
                <p class="detail-value">{{ employee?.personalId }}</p>
              }
            </div>
            <div class="detail-item">
              @if (isEditMode) {
                <label class="detail-label"></label>
                <select class="detail-input" [(ngModel)]="employee.gender">
                  <option value="M">专</option>
                  <option value="F">拽</option>
              </select>
              }@else {  
              <label class="detail-label"></label>
              <p class="detail-value">{{ employee?.gender === 'M' ? '专' : '拽' }}</p>
              }
            </div>
            <div class="detail-item">
              @if (isEditMode) {
                <label class="detail-label">转专 </label>
                <input type="date" class="detail-input" [(ngModel)]="employee.birthDate" />
              }@else {
                <label class="detail-label">转专 </label>
                <p class="detail-value">{{ employee?.birthDate | date:'dd/MM/yyyy' }}</p>
              }
            </div>
            <div class="detail-item">
              @if (isEditMode) {
                <label class="detail-label">爪 砖驻转</label>
                <select class="detail-input" [(ngModel)]="employee.familyStatus">
                  <option value="single">专拽/</option>
                  <option value="married">砖/</option>
                  <option value="divorced">专砖/</option>
                  <option value="widowed">/</option>
                </select>
              }@else {
                <label class="detail-label">爪 砖驻转</label>
                <p class="detail-value">{{ translateMaritalStatus(employee?.familyStatus) }}</p>
              }
            </div>
          </div>
        </div>

        <div class="details-section">
          <div class="section-header-with-button">
            <h3 class="details-header-title"> 驻专 拽砖专</h3>
          </div>
          
          <div class="details-grid">
            <div class="detail-item">
              @if (isEditMode) {
                <label class="detail-label">驻 </label>
                <input type="text" class="detail-input" [(ngModel)]="employee.phone" maxlength="10">
              }@else {
                <label class="detail-label">驻 </label>
                <p class="detail-value">{{ employee?.phone }}</p>
              }
            </div>
            <div class="detail-item">
              @if (isEditMode) {
                <label class="detail-label">"</label>
                <input type="email" class="detail-input" [(ngModel)]="employee.email" />
              }@else {
                <label class="detail-label">"</label>
                <p class="detail-value">{{ employee?.email }}</p>
              }
            </div>
            <div class="detail-item">
              @if (isEditMode) {
                <label class="detail-label">转转</label>
                <input type="text" class="detail-input" [(ngModel)]="employee.address" />
              }@else {
                <label class="detail-label">转转</label>
                <p class="detail-value">{{ employee?.address }}</p>
              }
            </div>
            <div class="detail-item">
              @if (isEditMode) {
                <label class="detail-label">注专</label>
                <input type="text" class="detail-input" [(ngModel)]="employee.city" />
              }@else {
                <label class="detail-label">注专</label>
                <p class="detail-value">{{ employee?.city }}</p>
              }
            </div>
            <div class="detail-item">
              @if (isEditMode) {
                <label class="detail-label"></label>
                <input type="text" class="detail-input" [(ngModel)]="employee.country" />
              }@else {
                <label class="detail-label"></label>
                <p class="detail-value">{{ employee?.country }}</p>
              }
            </div>
          </div>
        </div>

        <div class="details-section">
          <h3 class="details-header-title"> 驻专 砖专</h3>
          <div class="details-grid">
            <div class="detail-item">
              @if (isEditMode) {
                <label class="detail-label">转驻拽</label>
                <input type="text" class="detail-input" [(ngModel)]="employee.position" />
              }@else {
                <label class="detail-label">转驻拽</label>
                <p class="detail-value">{{ employee?.position }}</p>
              }
            </div>
            <div class="detail-item">
              @if (isEditMode) {
                <label class="detail-label">拽</label>
                <select class="detail-input" [(ngModel)]="employee.department">
                  <option value="DEV">驻转</option>
                  <option value="HR">砖 砖</option>
                  <option value="IT">转</option>
                  <option value="Sales">专转</option>
                  <option value="Marketing">砖拽</option>
                  <option value="Finance">住驻</option>
                  <option value="Manegment"></option>
                </select>
              }@else {
                <label class="detail-label">拽</label>
                <p class="detail-value">{{ employee?.department }}</p>
              }
            </div>
            <div class="detail-item">
              @if (isEditMode) {
                <label class="detail-label">转专 转</label>
                <input type="date" class="detail-input" [(ngModel)]="employee.hireDate" />
              }@else {
                <label class="detail-label">转专 转</label>
                <p class="detail-value">{{ employee?.hireDate | date:'dd/MM/yyyy' }}</p>
              }
            </div>
            <div class="detail-item">
              @if (isEditMode) {
                <label class="detail-label">住 砖专</label>
                <select class="detail-input" [(ngModel)]="employee.jobType">
                  <option value="full-time">砖专 </option>
                  <option value="part-time">砖专 拽转</option>
                  <option value="contractor">拽</option>
                </select>
              }@else {
                <label class="detail-label">住 砖专</label>
                <p class="detail-value">{{ translateEmploymentType(employee?.jobType) }}</p>
              }
            </div>
            <div class="detail-item">
              @if (isEditMode) {
                <label class="detail-label">住住</label>
                <select class="detail-input" [(ngModel)]="employee.status">
                  <option value="Active">驻注</option>
                  <option value="Inactive"> 驻注</option>
                </select>
              }@else {
                <label class="detail-label">住住</label>
                <p class="detail-value">
                  <span [class]="'status-badge status-' + employee?.status?.toLowerCase()">
                    {{ translateStatus(employee?.status) }}
                  </span>
                </p>
              }
            </div>
          </div>
        </div>
      </div>
    }
    
    <!-- Documents Tab -->
    @if (activeTab === 'documents') {
      <div class="tab-content documents-tab">
        <div class="documents-grid">
          @if (documents && documents.length > 0) {
            @for (doc of documents; track doc.id) {
              <div class="document-card">
                <div class="document-icon">
                  <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                    <polyline points="14 2 14 8 20 8" />
                    <line x1="12" y1="13" x2="12" y2="17" />
                    <line x1="10" y1="15" x2="14" y2="15" />
                  </svg>
                </div>
                <h4 class="document-name">{{ doc.name }}</h4>
                <p class="document-type">{{ doc.type }}</p>
                <p class="document-date">{{ doc.uploadDate | date:'dd/MM/yyyy' }}</p>
                <div class="document-actions">
                  <button class="doc-btn btn-view">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="white">
                      <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                      <circle cx="12" cy="12" r="3" />
                    </svg>
                    爪驻
                  </button>
                  <button class="doc-btn btn-download">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="white">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                      <polyline points="7 10 12 15 17 10" />
                      <line x1="12" y1="15" x2="12" y2="3" />
                    </svg>
                    专
                  </button>
                </div>
              </div>
            }
          } @else {
            <div class="empty-state">
              <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#cbd5e1" stroke-width="1.5">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                <polyline points="14 2 14 8 20 8" />
              </svg>
              <p> 住 爪</p>
            </div>
          }
        </div>
      </div>
    }

    <!-- Salary Tab -->
    @if (activeTab === 'salary') {
      <div class="tab-content salary-tab">
        <div class="salary-section">
          <div class="section-header-with-button">
            <h3 class="details-header-title"> 驻专 砖专转</h3>
            @if (isEditMode) {
              <button class="edit-save-btn btn-save" (click)="saveChanges()" aria-label="砖专">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                  <polyline points="17 21 17 13 7 13 7 21"></polyline>
                  <polyline points="7 3 7 8 15 8"></polyline>
                </svg>
                <span>砖专</span>
              </button>
            }@else {
              <button class="edit-save-btn btn-edit" (click)="toggleEditMode()" aria-label="注专">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M12 20h9"></path>
                  <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
                </svg>
                <span>注专</span>
              </button>
            }
          </div>

          <div class="details-grid">
            <div class="detail-item">
              @if (isEditMode) {
                <label class="detail-label">砖专 住住</label>
                <input type="number" class="detail-input" [(ngModel)]="employee.baseSalary" />
              }@else {
                <label class="detail-label">砖专 住住</label>
                <p class="detail-value">{{ formatNumber(employee?.baseSalary) }}</p>
              }
            </div>
            <div class="detail-item">
              @if (isEditMode) {
                <label class="detail-label">住</label>
                <input type="number" class="detail-input" [(ngModel)]="employee.bonus" />
              }@else {
                <label class="detail-label">住</label>
                <p class="detail-value">{{ formatNumber(employee?.bonus) }}</p>
              }
            </div>
            <div class="detail-item">
              @if (isEditMode) {
                <label class="detail-label">拽爪</label>
                <input type="number" class="detail-input" [(ngModel)]="employee.allowance" />
              }@else {
                <label class="detail-label">拽爪</label>
                <p class="detail-value">{{ formatNumber(employee?.allowance) }}</p>
              }
            </div>
            <div class="detail-item">
              <label class="detail-label">住" 砖专转 砖</label>
              <p class="detail-value total-salary">{{ formatNumber(calculateTotalSalary()) }}</p>
            </div>
          </div>
        </div>

        <div class="salary-section">
          <h3 class="details-header-title"> 住专转 砖专转</h3>
          <div class="salary-history">
            @if (salaryHistory && salaryHistory.length > 0) {
              <div class="salary-table">
                <div class="table-header">
                  <div class="table-cell">砖</div>
                  <div class="table-cell">砖专转 住住转</div>
                  <div class="table-cell">住</div>
                  <div class="table-cell"></div>
                  <div class="table-cell">住"</div>
                </div>
                @for (salary of salaryHistory; track salary.id) {
                  <div class="table-row">
                    <div class="table-cell">{{ salary.month }}/{{ salary.year }}</div>
                    <div class="table-cell">{{ formatNumber(salary.baseSalary) }}</div>
                    <div class="table-cell">{{ formatNumber(salary.bonus) }}</div>
                    <div class="table-cell">{{ formatNumber(salary.deductions) }}</div>
                    <div class="table-cell total-salary">{{ formatNumber(salary.total) }}</div>
                  </div>
                }
              </div>
            } @else {
              <div class="empty-state">
                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#cbd5e1" stroke-width="1.5">
                  <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" />
                </svg>
                <p> 住专转 砖专转</p>
              </div>
            }
          </div>
        </div>
      </div>
    }
  </div>
</div>